<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GraphNeo4jExporter.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">library</a> &gt; <a href="index.source.html" class="el_package">repository.implementation.neo4j</a> &gt; <span class="el_source">GraphNeo4jExporter.kt</span></div><h1>GraphNeo4jExporter.kt</h1><pre class="source lang-java linenums">package repository.implementation.neo4j

import graph.Graph
import org.neo4j.driver.AuthTokens
import org.neo4j.driver.Driver
import org.neo4j.driver.GraphDatabase
import org.neo4j.driver.Session
import repository.GraphExporter
import java.io.File

<span class="nc" id="L11">class GraphNeo4jExporter : GraphExporter {</span>
<span class="nc" id="L12">    private val uri = &quot;bolt://localhost:7687&quot;</span>
<span class="nc" id="L13">    private val user = &quot;neo4j&quot;</span>
<span class="nc" id="L14">    private val password = &quot;12345678&quot;</span>

    override fun &lt;V, E&gt; exportGraph(graph: Graph&lt;V, E&gt;, file: File) {
<span class="nc" id="L17">        val driver: Driver = GraphDatabase.driver(uri, AuthTokens.basic(user, password))</span>
<span class="nc" id="L18">        driver.use {</span>
<span class="nc" id="L19">            val session: Session = it.session()</span>
<span class="nc" id="L20">            session.executeWrite { tx -&gt;</span>
                // Export nodes
<span class="nc" id="L22">                graph.vertexSet().forEach { vertex -&gt;</span>
<span class="nc" id="L23">                    tx.run(&quot;CREATE (n:Node {value: \$value})&quot;, mapOf(&quot;value&quot; to vertex))</span>
<span class="nc" id="L24">                }</span>

                // Export edges
<span class="nc" id="L27">                graph.edgeSet().forEach { edge -&gt;</span>
<span class="nc" id="L28">                    val tail = graph.getEdgeTail(edge)</span>
<span class="nc" id="L29">                    val head = graph.getEdgeHead(edge)</span>
<span class="nc" id="L30">                    val weight = graph.getEdgeWeight(edge)</span>

<span class="nc" id="L32">                    tx.run(</span>
                        &quot;&quot;&quot;
<span class="nc" id="L34">                        MATCH (a:Node {value: \$tail})</span>
<span class="nc" id="L35">                        MATCH (b:Node {value: \$head})</span>
<span class="nc" id="L36">                        CREATE (a)-[:EDGE {value: \$edge, weight: \$weight}]-&gt;(b)</span>
<span class="nc" id="L37">                        &quot;&quot;&quot;.trimIndent(),</span>
<span class="nc" id="L38">                        mapOf(&quot;tail&quot; to tail, &quot;head&quot; to head, &quot;edge&quot; to edge, &quot;weight&quot; to weight)</span>
                    )
<span class="nc" id="L40">                }</span>
<span class="nc" id="L41">            }</span>
<span class="nc" id="L42">            session.close()</span>
<span class="nc" id="L43">        }</span>
<span class="nc" id="L44">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>